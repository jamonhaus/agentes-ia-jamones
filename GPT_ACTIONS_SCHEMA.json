{
  "openapi": "3.1.0",
  "info": {
    "title": "Orquestador de Agentes IA - Jamonhaus",
    "description": "API para coordinación y colaboración entre agentes especializados en negocio de jamones premium. Coordinación asíncrona para permitir colaboración completa entre agentes.",
    "version": "1.1.0"
  },
  "servers": [
    {
      "url": "https://agentes-ia-jamones.onrender.com"
    }
  ],
  "paths": {
    "/gpt/smart/request": {
      "post": {
        "description": "Inicia coordinación automática asíncrona. Devuelve job_id para consultar progreso. Los agentes colaborarán entre sí.",
        "operationId": "smartRequestAsync",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["request"],
                "properties": {
                  "request": {
                    "type": "string",
                    "description": "La petición del usuario que requiere coordinación de múltiples agentes especializados"
                  },
                  "context": {
                    "type": "object",
                    "description": "Contexto adicional opcional para la petición",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Job iniciado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "job_id": {
                      "type": "string",
                      "description": "ID del trabajo para consultar estado"
                    },
                    "status": {
                      "type": "string",
                      "description": "Estado inicial: queued"
                    },
                    "message": {
                      "type": "string"
                    },
                    "estimated_time": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/gpt/smart/status/{job_id}": {
      "get": {
        "description": "Consulta el estado de un trabajo de coordinación. Debes llamar a este endpoint repetidamente hasta que status sea 'completed' o 'failed'.",
        "operationId": "checkJobStatus",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID del job devuelto por /gpt/smart/request"
          }
        ],
        "responses": {
          "200": {
            "description": "Estado del trabajo",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "job_id": {
                      "type": "string"
                    },
                    "status": {
                      "type": "string",
                      "enum": ["queued", "processing", "completed", "failed"],
                      "description": "Estado actual del trabajo"
                    },
                    "result": {
                      "type": "object",
                      "description": "Resultado completo cuando status=completed",
                      "properties": {
                        "peticion_original": {
                          "type": "string"
                        },
                        "tipo_trabajo": {
                          "type": "string"
                        },
                        "equipo_participante": {
                          "type": "array",
                          "items": {
                            "type": "object"
                          }
                        },
                        "conversaciones_entre_agentes": {
                          "type": "array",
                          "description": "CLAVE: Conversaciones que tuvieron los agentes entre sí",
                          "items": {
                            "type": "object",
                            "properties": {
                              "from_agent": {
                                "type": "string"
                              },
                              "to_agent": {
                                "type": "string"
                              },
                              "message": {
                                "type": "string"
                              },
                              "response": {
                                "type": "string"
                              }
                            }
                          }
                        },
                        "respuesta_final": {
                          "type": "string"
                        }
                      }
                    },
                    "error": {
                      "type": "string",
                      "description": "Mensaje de error si status=failed"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/gpt/task/execute": {
      "post": {
        "description": "Ejecuta una tarea específica con un agente individual sin coordinación del director",
        "operationId": "executeTask",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["agent_id", "task"],
                "properties": {
                  "agent_id": {
                    "type": "string",
                    "enum": [
                      "andres_director",
                      "adrian_datos",
                      "leo_partners",
                      "bruno_estrategia",
                      "francisco_success",
                      "lucia_canales",
                      "diego_automatizacion",
                      "camila_branding",
                      "valeria_legal",
                      "sofia_conversion",
                      "elena_inventario",
                      "carlos_logistica",
                      "marco_fiscal",
                      "lalo_ventas",
                      "antonio_prompts",
                      "nexus_valiant",
                      "markus_garcia",
                      "aurora_atencion"
                    ],
                    "description": "ID del agente específico a ejecutar"
                  },
                  "task": {
                    "type": "string",
                    "description": "Tarea específica para el agente"
                  },
                  "context": {
                    "type": "object",
                    "description": "Contexto adicional",
                    "additionalProperties": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Respuesta del agente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "agent": {
                      "type": "string"
                    },
                    "task_received": {
                      "type": "string"
                    },
                    "status": {
                      "type": "string"
                    },
                    "response": {
                      "type": "string"
                    },
                    "timestamp": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "description": "Verificar estado del orquestador y agentes disponibles",
        "operationId": "getStatus",
        "responses": {
          "200": {
            "description": "Estado del sistema",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "mensaje": {
                      "type": "string"
                    },
                    "versión": {
                      "type": "string"
                    },
                    "agentes_disponibles": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
